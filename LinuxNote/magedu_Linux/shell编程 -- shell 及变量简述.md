# shell编程初步

#### 程序=指令+数据  or  程序=算法+数据结构

### 编程风格：

- 面向过程：以指令为中心  数据服务于指令
- 面向对象：以数据为中心  指令服务于数据

### 程序执行方式
- 计算机：运行二进制指令
- 编程语言：
  + 低级：汇编
  + 高级：
    + 编译：高级语言-->编译器-->目标代码
    + 解释：高级语言-->解释器-->机器代码

### shell 编程基本内容 ：

1. 过程式( 支持 顺序/ 循环 / 选择 )
2. 解释执行

第一行必须写清楚执行这个脚本的解释器的文件路径

- `#!/bin/bash`
- `#!/usr/bin/python`
- `#!/usr/bin/perl`
  
### Note_1：`shebang` 机制

### Note_2：`magic number`:魔数

### 运行脚本：
1. 给予运行权限 通过具体的文件路径制定文件执行
2. 直接运行解释器  将脚本作为解释器程序的参数执行

### shell中的变量种类
根据变量的生效范围来进行划分：
- 本地变量：生效范围为当前 shell 进程；对当前 shell 之外的其他 shell 进程 （ 包括当前 shell 的子 shell 进程 ） 无效
- 环境变量：生效范围为当前 shell 进程及其子进程
- 局部变量：生效范围为当前 shell 进程中某代码片段 (通常指函数上下文)

特殊类型
- 位置变量：用于让脚本在脚本代码中调用命令行传递给它的参数

### 详细说明

#### 本地变量：
- 变量赋值： 
```bash
# 使用单引号或双引号皆可，“=”号为赋值号，左侧为变量名，右侧为值
# 单双引号区别见下 Note 
# （1）可以是直接字符串
name = "value" / 'value'
# （2） 可以是变量引用
name = $value
# （3）可以是命令引用——将命令执行结果赋值给变量，推荐使用第二种写法，即 $( )
name = ` COMMAND ` / name = $(COMMAND)
```
- 变量引用：
```bash
# {}可省略 故大多数情况下采取第二种写法调用，name代表变量名
${name} / $name
```

#### Note_1 ：要看某 shell 是不是某 shell 的子进程 —— `pstree`命令可以显示系统当前进程树
#### Note_2 : `" "` 双引号表示弱引用，其中的变量引用会被替换为变量值
#### Note_3 ：`‘ ’` 单引号表示强引用，其中的变量引用不会被替换为变量值，而保持原字符串 

显示已定义的所有变量：
```bash
set
```
销毁变量：
```bash
unset name
```
#### 环境变量：
- 变量声明、赋值：
  + `export name=VALUE` —— 将一个变量导出为环境变量使用
  + `declare -x name=VALUE`
- 变量引用与之前叙述到的本地变量相同
- 显示所有环境变量
```bash
export
env
printenv
```
- 销毁环境变量命令也与本地变量相同
#### Note： bash 内有很多内建的环境变量，比如：`PATH` ；`SHELL` ；`UID `  ;  `HISTSIZE` ；`HOME` ; `PWD` ; `OLD` ; `HISTFILE`; `PS1`,这些必要谨慎修改
#### 变量命名法则：
1. 不能使用程序保留字
2. 只能使用数字、字母、下划线。不能以数字开头
3. 尽量见名知义，可参考其他编程语言命名法则 —— 驼峰命名法
#### 只读变量：
相当于其它编程语言中的常量，不可被销毁，不可被更改，随着 shell 进程的销毁而销毁

实现代码如下：

```bash
readonly name
declare -r name
```
使用 `readnoly` 或 `declare` 关键字来声明，`name` 表示变量名

#### 位置变量
在脚本代码中调用通过命令行传递给脚本的参数：

- `$1`，`$2`,`$3` —— 对应调用第一，第二，第 n 个参数
  + `shift [n]` 操作，可进行参数切片
- `$?` —— 上条命令的返回状态
- `$0` —— 输出命令本身
- `$*` —— 把传递给脚本的所有参数，当做一个字符串输出
- `$@` —— 把传递给脚本的所有参数，当做不同字符串输出
- `$#` —— 传递给脚本的参数的个数